name: Big Alpha Kings Automated Data Pipeline

on:
  schedule:
    # Run monthly on the 15th at 21:00 UTC (~4pm/5pm ET depending on DST)
    - cron: '0 21 15 * *'

  # Allow manual triggering
  workflow_dispatch:
    inputs:
      reason:
        description: 'Reason for manual run'
        required: false
        default: 'Manual trigger'

jobs:
  update-data:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ”¥ Checkout Repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    
    - name: ğŸ Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: ğŸ“¦ Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pandas requests openai firebase-admin fastapi uvicorn
    
    - name: ğŸš€ Run Automated Data Pipeline
      run: |
        echo "ğŸ”¥ BIG ALPHA KINGS AUTOMATED DATA PIPELINE ğŸ”¥"
        echo "â° Running at: $(date)"
        python automated_data_pipeline.py
    
    - name: ğŸ“Š Check Results
      run: |
        echo "ğŸ“ˆ Checking generated files..."
        ls -la AIBrain/JSONS/
        echo "ğŸ“Š File sizes:"
        du -h AIBrain/JSONS/*.json
    
    - name: ğŸ‰ Pipeline Complete
      run: |
        echo "âœ… Automated data pipeline completed successfully!"
        echo "ğŸš€ AI data is now fresh and deployed!"
        echo "ğŸ“… Next scheduled run: Check workflow schedule"


