name: Big Alpha Kings Automated Data Pipeline

on:
  schedule:
    # Run monthly on the 15th at 21:00 UTC (~4pm/5pm ET depending on DST)
    - cron: '0 21 15 * *'

  # Allow manual triggering
  workflow_dispatch:
    inputs:
      reason:
        description: 'Reason for manual run'
        required: false
        default: 'Manual trigger'

jobs:
  update-data:
    runs-on: ubuntu-latest
    
    steps:
    - name: 🔥 Checkout Repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
    
    - name: 🐍 Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: 📦 Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install pandas requests openai firebase-admin fastapi uvicorn
    
    - name: 🚀 Run Automated Data Pipeline
      run: |
        echo "🔥 BIG ALPHA KINGS AUTOMATED DATA PIPELINE 🔥"
        echo "⏰ Running at: $(date)"
        python automated_data_pipeline.py
    
    - name: 📊 Check Results
      run: |
        echo "📈 Checking generated files..."
        ls -la AIBrain/JSONS/
        echo "📊 File sizes:"
        du -h AIBrain/JSONS/*.json
    
    - name: 🎉 Pipeline Complete
      run: |
        echo "✅ Automated data pipeline completed successfully!"
        echo "🚀 AI data is now fresh and deployed!"
        echo "📅 Next scheduled run: Check workflow schedule"


